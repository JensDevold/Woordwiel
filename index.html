<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Woordwiel: Creatieve Vrijheid</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      text-align: center;
    }
    #spel, #woordenlijst {
      display: inline-block;
      vertical-align: top;
      width: 45%;
      margin: 10px;
    }
    .circle-container {
      position: relative;
      width: 250px;
      height: 250px;
      margin: 0 auto 10px auto;
    }
    .letter {
      position: absolute;
      width: 50px;
      height: 50px;
      background-color: #f0f0f0;
      border-radius: 50%;
      font-size: 24px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      transform: translate(-50%, -50%);
      transition: background-color 0.3s;
      cursor: pointer;
    }
    .center {
      top: 50%;
      left: 50%;
      background-color: #66ccff;
    }
    .circle-container .letter:not(.center) {
      top: calc(50% + 90px * sin(var(--angle)));
      left: calc(50% + 90px * cos(var(--angle)));
    }
    #controleerKnop {
      margin-top: 10px;
      font-size: 20px;
      padding: 8px 16px;
      background-color: #66ccff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      margin: 5px;
      width: 80%;
    }
    #resultaat {
      font-size: 18px;
      font-weight: bold;
      color: #cc0000;
      margin-bottom: 10px;
    }
    #score, #timer, #totaal {
      font-size: 18px;
      margin-top: 10px;
    }
    ul {
      list-style-type: none;
      padding-left: 0;
    }
    li {
      margin-bottom: 6px;
    }
    #janPopup {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.8);
      z-index: 9998;
      text-align: center;
      color: white;
      padding-top: 100px;
    }
    #janPopup div {
      background: #ff69b4;
      margin: 0 auto;
      padding: 30px;
      border-radius: 20px;
      width: 500px;
      box-shadow: 0 0 20px white;
    }
    #vuurwerk {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 9999;
    }
    #vuurwerk div {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      position: absolute;
      animation: explode 3s ease-out forwards;
    }
    @keyframes explode {
      0% { transform: scale(0); opacity: 1; }
      100% { transform: scale(3); opacity: 0; }
    }
    .highlight {
      background-color: #ffcc00 !important;
    }
  </style>
</head>
<body>

  <div id="spel">
    <h1>üé® Woordwiel: Creatieve Vrijheid</h1>
    <p>Gebruik de letters en zorg dat elk woord de <strong>middelste letter E</strong> bevat. Minstens 4 letters!</p>

    <div class="circle-container" id="woordwiel">
      <div class="letter center" data-letter="E">E</div>
    </div>

    <button id="controleerKnop" onclick="controleerWoord()">‚û°Ô∏è</button>

    <div id="resultaat"></div>
    <input type="text" id="inputwoord" placeholder="Typ een woord..." onkeydown="handleKey(event)" oninput="startTimer(); filterInput()" />
    <button onclick="controleerWoord()">Controleer</button>
    <button onclick="togglePause()">‚è∏Ô∏è Pauzeer / Hervat</button>
    <button onclick="rotateLetters()">üîÑ Wissel letters</button>
    <button onclick="toonHint()">üí° Hint</button>
    <button onclick="toonOplossing()">üß© Toon oplossing</button>
    <button onclick="resetSpel()">üîÑ Reset spel</button>

    <div id="score">Score: 0</div>
    <div id="totaal">Woorden gevonden: 0 / 21</div>
    <div id="timer">Tijd: 0:00</div>
  </div>
<div id="woordenlijst">
    <h3>üß† Gevonden woorden</h3>
    <ul id="gevonden"></ul>
  </div>

  <div id="janPopup">
    <div>
      <h2>üéâ Bedankt Jan!</h2>
      <p>Voor al je jaren bij ons, je vriendschap, je kennis, en je legendarische dad jokes.<br>We gaan je missen!</p>
      <button onclick="sluitJanPopup()">Sluiten</button>
    </div>
  </div>
  <div id="vuurwerk"></div>

<script>
const centerLetter = 'E';
let outerLetters = ['P', 'N', 'S', 'I', 'O', 'E', 'N'];
const letterLimieten = { P: 1, E: 2, N: 2, S: 1, I: 1, O: 1 };

const woordenUitleg = {
  'pensioen': 'periode waarin je stopt met werken',
  'pens': 'buik of ingewanden',
  'penis': 'mannelijk geslachtsorgaan',
  'open': 'niet gesloten',
  'poen': 'informeel voor geld',
  'pone': 'stellen of beweren',
  'peen': 'wortelgroente',
  'neep': 'dialect voor raap',
  'neon': 'edelgas, vaak gebruikt in verlichting',
  'nies': 'reflex van de neus',
  'peil': 'hoogte of niveau van iets',
  'pen': 'voorwerp om mee te schrijven',
  'sein': 'signaal of teken',
  'siep': 'regionaal woord voor zeef of filter',
  'peis': 'Vlaams woord voor rust of vrede',
  'ponee': 'variant op pone',
  'neps': 'meervoud van nep, iets dat niet echt is',
  'openen': 'iets toegankelijk maken of ontgrendelen',
  'pien': 'verkorte meisjesnaam, ook als zelfstandig woord in dialect',
  'seep': 'dialect voor zeep',
  'sien': 'oud-Nederlands voor zien of waarnemen'
};

let gevondenWoorden = [];
let score = 0;
let seconden = 0;
let timerStarted = false;
let timerPaused = false;
let timerInterval;
let hintIndex = 0;
let hintsGebruikt = 0;
let vuurwerkInterval;
let klikGeschiedenis = [];

function renderLetters() {
  const container = document.getElementById('woordwiel');
  container.innerHTML = '<div class="letter center" data-letter="E">E</div>';
  const total = outerLetters.length;
  outerLetters.forEach((letter, i) => {
    const angle = (360 / total) * i;
    const div = document.createElement('div');
    div.className = 'letter';
    div.setAttribute('data-letter', letter);
    div.style.setProperty('--angle', angle + 'deg');
    div.textContent = letter;
    div.onclick = () => toggleLetter(letter);
    container.appendChild(div);
  });
}

function toggleLetter(letter) {
  const lower = letter.toLowerCase();
  const max = letterLimieten[letter.toUpperCase()] || 0;
  const huidigeAantal = klikGeschiedenis.filter(l => l === lower).length;

  if (huidigeAantal < max) {
    klikGeschiedenis.push(lower);
  } else {
    const index = klikGeschiedenis.lastIndexOf(lower);
    if (index !== -1) {
      klikGeschiedenis.splice(index, 1);
    }
  }

  document.getElementById('inputwoord').value = klikGeschiedenis.join('');
  updateLetterHighlights();
  startTimer();
}

function updateLetterHighlights() {
  const letters = document.querySelectorAll('.letter');
  letters.forEach(el => el.classList.remove('highlight'));

  const telling = {};
  klikGeschiedenis.forEach(l => {
    telling[l] = (telling[l] || 0) + 1;
  });

  const gebruikt = {};

  letters.forEach(el => {
    const l = el.getAttribute('data-letter').toLowerCase();
    const max = letterLimieten[l.toUpperCase()] || 0;
    gebruikt[l] = (gebruikt[l] || 0);

    if ((telling[l] || 0) > gebruikt[l] && gebruikt[l] < max) {
      el.classList.add('highlight');
      gebruikt[l]++;
    }
  });
}
function startTimer() {
  if (!timerStarted) {
    timerStarted = true;
    timerInterval = setInterval(() => {
      if (!timerPaused) {
        seconden++;
        const min = Math.floor(seconden / 60);
        const sec = seconden % 60;
        document.getElementById('timer').innerText = `Tijd: ${min}:${sec.toString().padStart(2, '0')}`;
      }
    }, 1000);
  }
}

function togglePause() {
  timerPaused = !timerPaused;
}

function handleKey(e) {
  if (e.key === 'Enter') {
    controleerWoord();
    document.getElementById('inputwoord').value = '';
    klikGeschiedenis = [];
    updateLetterHighlights();
  }
}

function filterInput() {
  const input = document.getElementById('inputwoord');
  let waarde = input.value.toLowerCase().replace(/[^a-z]/g, '');
  let telling = {};
  let gefilterd = [];

  for (let letter of waarde) {
    const upper = letter.toUpperCase();
    if (!letterLimieten[upper]) continue;
    telling[upper] = (telling[upper] || 0) + 1;
    if (telling[upper] <= letterLimieten[upper]) {
      gefilterd.push(letter);
    }
  }

  klikGeschiedenis = gefilterd;
  input.value = klikGeschiedenis.join('');
  updateLetterHighlights();
}

function controleerWoord() {
  const invoer = klikGeschiedenis.join('');
  const resultaat = document.getElementById('resultaat');
  const lijst = document.getElementById('gevonden');

  if (invoer.length < 4) {
    resultaat.innerText = "‚ùå Minstens 4 letters!";
    return;
  }

  if (!invoer.includes(centerLetter.toLowerCase())) {
    resultaat.innerText = `‚ùå Moet de letter '${centerLetter}' bevatten!`;
    return;
  }

  const telling = {};
  for (let letter of invoer) {
    const upper = letter.toUpperCase();
    if (!letterLimieten[upper]) {
      resultaat.innerText = "‚ùå Ongeldige letter!";
      return;
    }
    telling[upper] = (telling[upper] || 0) + 1;
    if (telling[upper] > letterLimieten[upper]) {
      resultaat.innerText = `‚ùå Te veel van de letter '${upper}' gebruikt!`;
      return;
    }
  }

  if (woordenUitleg[invoer]) {
    if (!gevondenWoorden.includes(invoer)) {
      gevondenWoorden.push(invoer);
      score++;
      document.getElementById('score').innerText = "Score: " + score;
      document.getElementById('totaal').innerText = `Woorden gevonden: ${gevondenWoorden.length} / ${Object.keys(woordenUitleg).length}`;
      const uitleg = woordenUitleg[invoer];
      const nieuwItem = document.createElement('li');
      nieuwItem.innerText = `${invoer} (${uitleg})`;
      lijst.appendChild(nieuwItem);
      klikGeschiedenis = [];
      document.getElementById('inputwoord').value = '';
      updateLetterHighlights();
      document.getElementById('resultaat').innerText = '';
      if (gevondenWoorden.length === Object.keys(woordenUitleg).length) {
        toonJanPopup();
      }
    } else {
      resultaat.innerText = "‚ÑπÔ∏è Dat woord heb je al gevonden.";
    }
  } else {
    resultaat.innerText = "‚ùå Geen geldig woord in deze puzzel.";
  }
}

function rotateLetters() {
  outerLetters = outerLetters.sort(() => Math.random() - 0.5);
  renderLetters();
}

function toonHint() {
  const resterend = Object.keys(woordenUitleg).filter(w => !gevondenWoorden.includes(w));
  if (resterend.length > 0) {
    const hintWoord = resterend[hintIndex % resterend.length];
    const uitleg = woordenUitleg[hintWoord];
    const lijst = document.getElementById('gevonden');
    const nieuwItem = document.createElement('li');
    nieuwItem.innerText = `${hintWoord} (${uitleg})`;
    lijst.appendChild(nieuwItem);
    gevondenWoorden.push(hintWoord);
    score++;
    hintsGebruikt++;
    document.getElementById('score').innerText = "Score: " + score;
    document.getElementById('totaal').innerText = `Woorden gevonden: ${gevondenWoorden.length} / ${Object.keys(woordenUitleg).length}`;
    document.getElementById('resultaat').innerText = '';
    hintIndex++;
    klikGeschiedenis = [];
    updateLetterHighlights();
    if (gevondenWoorden.length === Object.keys(woordenUitleg).length) {
      toonJanPopup();
    }
  }
}

function toonOplossing() {
  const lijst = document.getElementById('gevonden');
  const resterend = Object.keys(woordenUitleg).filter(w => !gevondenWoorden.includes(w));
  resterend.forEach(w => {
    const uitleg = woordenUitleg[w];
    const nieuwItem = document.createElement('li');
    nieuwItem.innerText = `${w} (${uitleg})`;
    lijst.appendChild(nieuwItem);
    gevondenWoorden.push(w);
    score++;
  });
  document.getElementById('score').innerText = "Score: " + score;
  document.getElementById('totaal').innerText = `Woorden gevonden: ${gevondenWoorden.length} / ${Object.keys(woordenUitleg).length}`;
  document.getElementById('resultaat').innerText = '';
  klikGeschiedenis = [];
  updateLetterHighlights();
  toonJanPopup();
}

function resetSpel() {
  gevondenWoorden = [];
  score = 0;
  seconden = 0;
  timerStarted = false;
  timerPaused = false;
  hintIndex = 0;
  hintsGebruikt = 0;
  klikGeschiedenis = [];
  clearInterval(timerInterval);
  document.getElementById('inputwoord').value = '';
  document.getElementById('gevonden').innerHTML = '';
  document.getElementById('score').innerText = "Score: 0";
  document.getElementById('totaal').innerText = `Woorden gevonden: 0 / ${Object.keys(woordenUitleg).length}`;
  document.getElementById('timer').innerText = "Tijd: 0:00";
  document.getElementById('resultaat').innerText = '';
  updateLetterHighlights();
  renderLetters();
}

function toonJanPopup() {
  document.getElementById('janPopup').style.display = 'block';
  vuurwerkInterval = setInterval(vuurwerkAnimatie, 1000);
}

function sluitJanPopup() {
  document.getElementById('janPopup').style.display = 'none';
  clearInterval(vuurwerkInterval);
  document.getElementById('vuurwerk').innerHTML = '';
}

function vuurwerkAnimatie() {
  const container = document.getElementById('vuurwerk');
  for (let i = 0; i < 20; i++) {
    const dot = document.createElement('div');
    dot.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
    dot.style.top = Math.random() * window.innerHeight + 'px';
    dot.style.left = Math.random() * window.innerWidth + 'px';
    container.appendChild(dot);
    setTimeout(() => dot.remove(), 3000);
  }
}

renderLetters();
</script>
</body>
</html>
